/**
 * Moon Compiler v1.0.0-beta.7
 * Copyright 2016-2020 kbrsh
 * Released under the MIT License
 * https://moonjs.org
 */
!function(n,t){"undefined"==typeof module?n.MoonCompiler=t():module.exports=t()}(this,(function(){"use strict";var n=/[-$\w.]/;function t(n,t){this.expected=n,this.index=t}var e=function(n,e){return function(r,o){var a=e(r,o);return a instanceof t?a:[{type:n,value:a[0]},a[1]]}},r=function(n,e){return e===n.length?["EOF",e]:new t("EOF",e)},o=function(n,e){return e<n.length?[n[e],e+1]:new t("any",e)},a=function(n){return function(e,r){var o=e[r];return o===n?[o,r+1]:new t('"'+n+'"',r)}},i=function(n){return function(e,r){var o=e[r];return void 0!==o&&n.test(o)?[o,r+1]:new t(n.toString(),r)}},u=function(n){return function(e,r){var o=r+n.length;return e.slice(r,o)===n?[n,o]:new t('"'+n+'"',r)}},s=function(n){return function(e,r){if(r<e.length){for(var o=0;o<n.length;o++){var a=n[o];if(e.slice(r,r+a.length)===a)return new t('not "'+a+'"',r)}return[e[r],r+1]}return new t("not "+n.map(JSON.stringify).join(", "),r)}},l=function(n,e){return function(r,o){var a=n(r,o);return a instanceof t&&a.index===o?e(r,o):a}},f=function(n,e){return function(r,o){var a=n(r,o);if(a instanceof t)return a;var i=e(r,a[1]);return i instanceof t?i:[[a[0],i[0]],i[1]]}},c=function(n){return function(e,r){for(var o=[],a=0;a<n.length;a++){var i=n[a](e,r);if(i instanceof t)return i;o.push(i[0]),r=i[1]}return[o,r]}},p=function(n){return function(e,r){for(var o=new t("alternates",-1),a=0;a<n.length;a++){var i=n[a](e,r);if(!(i instanceof t&&i.index===r))return i;i.index>o.index&&(o=i)}return o}},d=function(n){return function(e,r){for(var o,a=[];!((o=n(e,r))instanceof t);)a.push(o[0]),r=o[1];return o.index===r?[a,r]:o}},v=function(n){return function(e,r){var o=[],a=n(e,r);if(a instanceof t)return a;for(o.push(a[0]),r=a[1];!((a=n(e,r))instanceof t);)o.push(a[0]),r=a[1];return a.index===r?[o,r]:a}},h=function(n){return function(e,r){var o=n(e,r);return o instanceof t&&(o.index=r),o}},g=function(n){return function(e,r){var o=n(e,r);return o instanceof t&&o.index===r?[null,r]:o}},m={comment:e("comment",c([a("#"),d(l(f(a("\\"),o),s(["#"]))),a("#")])),separator:function(n,t){return d(l(p([a(" "),a("\t"),a("\n")]),m.comment))(n,t)},value:function(t,e){return p([v(i(n)),c([a('"'),d(l(f(a("\\"),o),s(['"']))),a('"')]),c([a("'"),d(l(f(a("\\"),o),s(["'"]))),a("'")]),c([a("`"),d(l(f(a("\\"),o),s(["`"]))),a("`")]),c([a("("),m.expression,a(")")]),c([a("["),m.expression,a("]")]),c([a("{"),m.expression,a("}")])])(t,e)},attributes:function(n,t){return e("attributes",d(c([m.value,g(c([a("="),m.value])),m.separator])))(n,t)},text:e("text",v(l(f(a("\\"),o),s(["{","<"])))),fragment:function(n,t){return e("fragment",c([u("<>"),d(p([h(m.node),h(m.nodeData),h(m.nodeDataChildren),h(m.fragment),m.text,m.interpolation])),u("</>")]))(n,t)},interpolation:function(n,t){return e("interpolation",c([a("{"),m.expression,a("}")]))(n,t)},node:function(n,t){return e("node",c([a("<"),m.separator,m.value,m.separator,u("*>")]))(n,t)},nodeData:function(n,t){return e("nodeData",c([a("<"),m.separator,m.value,m.separator,l(h(m.attributes),m.value),u("/>")]))(n,t)},nodeDataChildren:function(n,t){return e("nodeDataChildren",c([a("<"),m.separator,m.value,m.separator,m.attributes,a(">"),d(p([h(m.node),h(m.nodeData),h(m.nodeDataChildren),h(m.fragment),m.text,m.interpolation])),u("</"),d(s([">"])),a(">")]))(n,t)},expression:function(n,t){return d(p([c([u("//"),d(s(["\n"]))]),c([u("/*"),d(s(["*/"])),u("*/")]),h(c([a("/"),v(l(f(a("\\"),s(["\n"])),s(["/","\n"]))),a("/")])),m.comment,m.value,h(m.node),h(m.nodeData),h(m.nodeDataChildren),h(m.fragment),a("/"),a("<"),v(s(["/","#",'"',"'","`","(",")","[","]","{","}","<"]))]))(n,t)},main:function(n,t){return f(m.expression,r)(n,t)}};function x(n){return m.main(n,0)}var b=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","element","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","image","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","math","menu","menuitem","meta","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rb","rbc","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","text","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"];function y(n,t){for(var e=t-n.length,r=0;r<e;r++)n=" "+n;return n}var w=/^\s+$/,M=/(^|[^\\])("|\n)/g;function D(n){return Array.isArray(n)&&3===n.length&&"{"===n[0]&&"}"===n[2]?n[1]:n}function A(n){if(!Array.isArray(n)||"{"!==n[0]||"}"!==n[n.length-1])return!1;var t=n[1];if(!Array.isArray(t))return!1;for(var e=!1,r=!1,o=0;o<t.length;o++){var a=t[o];if("?"===a)r=!0;else if(Array.isArray(a))for(var i=0;i<a.length;i++){var u=a[i];"?"===u&&(r=!0),":"===u&&(e=!0)}else"string"==typeof a&&(-1!==a.indexOf("?")&&(r=!0),-1!==a.indexOf(":")&&(e=!0))}return e&&!r}function C(n){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",e="",r=t,o=0;o<n.length;o++){var a=n[o];if("text"===a.type){var i=O(a);i.isWhitespace?e+=i.output:(e+=r+i.output,r=",")}else if("fragment"===a.type){var u=C(a.value[1],r);e+=u.output,r=u.separator}else"interpolation"===a.type?(e+=r+"...Moon.view.normalizeChildren("+O(a.value[1])+")",r=","):(e+=r+O(a),r=",")}return{output:e,separator:r}}function k(n){var t=O(n);return-1===b.indexOf(t)?t:"Moon.view.components."+t}function O(n){var t,e=n.type;if("string"==typeof n)return n;if(Array.isArray(n)){for(var r="",o=0;o<n.length;o++)r+=O(n[o]);return r}if("comment"===e)return"/*"+O(n.value[1])+"*/";if("attributes"===e){for(var a=n.value,i=[],u=[],s=0;s<a.length;s++){var l=a[s],f=O(D(l[0])),c="className"===(t=f)?"class":"htmlFor"===t?"for":"onChange"===t?"oninput":"onDoubleClick"===t?"ondblclick":"dangerouslySetInnerHTML"===t?"innerHTML":t,p=l[1],d=Array.isArray(p)&&"="===p[0]?p[1]:p,v=d&&A(d);if("..."===c.slice(0,3)){var h=c.slice(3)||O(D(d||[]));i.push(h)}else{var g=null===p?"true":v?"{"+O(d[1])+"}":O(D(d));u.push('"'+c+'":'+g)}}if(0===i.length)return{output:u.join(","),separator:0===u.length?"":",",isExpression:!1};var m=0===u.length?"{}":"{"+u.join(",")+"}";return{output:"Object.assign({}, "+i.join(",")+(u.length?", "+m:"")+")",separator:u.length||i.length?",":"",isExpression:!0}}if("text"===e){var x=O(n.value),b=w.test(x)&&-1!==x.indexOf("\n");return{output:b?x:'Moon.view.components.text({data:"'+x.replace(M,(function(n,t,e){return t+('"'===e?'\\"':"\\n\\\n")}))+'"})',isWhitespace:b}}if("interpolation"===e)return"Moon.view.components.text({data:"+O(n.value[1])+"})";if("node"===e){var y=n.value;return O(y[1])+k(y[2])+O(y[3])}if("nodeData"===e){var E=n.value,j=E[4];if("attributes"===j.type){var q=function(n){if(!n||1!==n.length)return null;var t=n[0],e=t[0],r=t[1],o=O(e);return null!==r||"{"!==o[0]&&"("!==o[0]&&"["!==o[0]||"{..."===o.slice(0,4)?null:O(D(e))}(j.value);if(null!==q)return""+O(E[1])+k(E[2])+O(E[3])+"("+q+")"}var F=O(j);return""+O(E[1])+k(E[2])+O(E[3])+"("+("attributes"===j.type?F.isExpression?F.output:"{"+F.output+"}":F)+")"}if("nodeDataChildren"===e){var P,R=n.value,S=O(R[4]),H=R[6],I=H.length>0,L=I?C(H):{output:""};if(S.isExpression)P=I?"Object.assign({}, "+S.output+", {children:["+L.output+"]})":S.output;else{var N=I?(S.separator||"")+"children:["+L.output+"]":"";P="{"+S.output+N+"}"}return""+O(R[1])+k(R[2])+O(R[3])+"("+P+")"}return"fragment"===e?"["+C(n.value[1]).output+"]":void 0}return{compile:function(n){var t=x(n);if("ParseError"===t.constructor.name){var e="Invalid Moon view syntax.\n"+function(n,t,e){for(var r=n.length;r<=t;r++)n+=" ";for(var o=n.split("\n"),a=1,i=1,u=0;u<n.length;u++){var s=n[u];if(u===t){var l=a+":"+i;return"Parse error: expected "+e+" at "+a+":"+i+"\n"+l+" "+(o[a-1]||"")+"\n"+" ".repeat(l.length+1+i-1)+"^"}"\n"===s?(a+=1,i=1):i+=1}return"Parse error: expected "+e+" at end of input"}(n,t.index,t.expected)+"\n\nContext:\n"+function(n,t){for(var e=n.length;e<=t;e++)n+=" ";for(var r=n.split("\n"),o=1,a=1,i=0;i<n.length;i++){var u=n[i];if(i===t){var s=o-1,l=o+1,f=Math.max(Math.floor(Math.log10(s)+1),Math.floor(Math.log10(o)+1),Math.floor(Math.log10(l)+1))+2,c=r[s-1],p=r[o-1],d=r[l-1],v="";return void 0!==c&&(v+=y(s+"| ",f)+c+"\n"),v+=y(o+"| ",f)+p+"\n"+y("| ",f)+y("^",a),void 0!==d&&(v+="\n"+y(l+"| ",f)+d),v}"\n"===u?(o+=1,a=1):a+=1}}(n,t.index);throw function(n){console.error("[Moon] ERROR: "+n)}(e),new Error(e)}return O(t[0][0])},generate:O,parse:x,version:"1.0.0-beta.7"}}));